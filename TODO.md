# 法的文書差分表示・PDF生成機能 開発TODO（TDD方式）

## 1. 縦書きレイアウト実装（視覚的調整・技術検証）

- [ ] 基本縦書きレイアウト実装
  - [ ] writing-mode: vertical-rl対応
  - [ ] 基本的な文字配置・回転
  - [ ] 番号付きリストの縦書き対応
- [ ] 罫線・枠線実装
  - [ ] 外枠罫線の描画
  - [ ] 内部区切り線の実装
  - [ ] 階層に応じた罫線スタイル
- [ ] 視覚的調整・改善
  - [ ] 表示確認とレイアウト微調整
  - [ ] 文字間・行間の調整
  - [ ] インデント表現の調整
  - [ ] ブラウザ互換性改善
- [ ] **DOC**: 縦書きレイアウト技術ドキュメント作成
  - [ ] CSS仕様書
  - [ ] レイアウト実装詳細ドキュメント

## 2. プロジェクト設計・準備

- [ ] 必要なライブラリ調査・選定
  - [ ] PDF生成ライブラリ（jsPDF, Puppeteer, @react-pdf/renderer等）
  - [ ] 差分検出ライブラリ（diff, jsdiff等）
  - [ ] テスティングライブラリ（Jest, Vitest, Testing Library等）
- [ ] データ構造設計
  - [ ] 入力テキストの構造定義
  - [ ] パース結果の中間データ構造定義
  - [ ] 差分情報の表現方法定義
- [ ] 技術仕様書作成
  - [ ] 罫線・枠線の配置ルール（縦書き実装結果を反映）
  - [ ] 差分表示（太字・強調線）の仕様
- [ ] テスト環境セットアップ
  - [ ] テストフレームワーク設定
  - [ ] テストデータ準備用ユーティリティ
  - [ ] モックライブラリ設定
  - [ ] CIパイプライン構築（テスト自動実行）

## 3. プレーンテキストパーサー実装（TDD）

- [ ] **RED**: パーサーテスト作成
  - [ ] 基本的な行解析のテスト
  - [ ] インデントレベル検出のテスト
  - [ ] 階層構造構築のテスト
  - [ ] 番号体系正規化のテスト
  - [ ] エラーケースのテスト
- [ ] **GREEN**: パーサー実装
  - [ ] 入力フォーマット仕様策定
  - [ ] 行単位の解析機能実装
  - [ ] インデントレベル検出実装
  - [ ] 階層構造の構築実装
  - [ ] 番号体系の正規化実装
- [ ] **REFACTOR**: パーサーリファクタリング
  - [ ] コード品質改善
  - [ ] エラーメッセージ改善
- [ ] **DOC**: パーサー技術ドキュメント作成
  - [ ] API仕様書（パーサー部分）
  - [ ] 実装詳細ドキュメント

## 4. 差分検出機能実装（TDD）

- [ ] **RED**: 差分検出テスト作成
  - [ ] 行単位差分検出のテスト
  - [ ] 文字単位差分検出のテスト
  - [ ] 構造変更検出のテスト
  - [ ] 複雑な変更パターンのテスト
- [ ] **GREEN**: 差分検出実装
  - [ ] 差分アルゴリズム選定・実装
  - [ ] 差分結果のデータ構造実装
  - [ ] 差分マージ機能実装
- [ ] **REFACTOR**: 差分検出リファクタリング
  - [ ] コード品質改善
- [ ] **DOC**: 差分検出技術ドキュメント作成
  - [ ] API仕様書（差分検出部分）
  - [ ] アルゴリズム詳細ドキュメント

## 5. 差分視覚化機能実装（TDD）

- [ ] **RED**: 差分視覚化テスト作成
  - [ ] 太字スタイル適用のテスト
  - [ ] 強調線（下線・取り消し線）のテスト
  - [ ] 色分け表示のテスト
  - [ ] 差分記号・マークのテスト
- [ ] **GREEN**: 差分視覚化実装
  - [ ] 差分スタイリング実装
  - [ ] 差分記号・マーク実装
  - [ ] レジェンド・説明表示実装
- [ ] **REFACTOR**: 差分視覚化リファクタリング
  - [ ] スタイル統一化
  - [ ] アクセシビリティ改善
- [ ] **DOC**: 差分視覚化技術ドキュメント作成
  - [ ] スタイル仕様書
  - [ ] 視覚化実装詳細ドキュメント

## 6. フロントエンドUI実装（TDD）

- [ ] **RED**: UIコンポーネントテスト作成
  - [ ] TextInputComponentのテスト
  - [ ] PreviewComponentのテスト
  - [ ] DownloadButtonComponentのテスト
  - [ ] LoadingComponentのテスト
  - [ ] レスポンシブ動作のテスト
- [ ] **GREEN**: UIコンポーネント実装
  - [ ] メインページのレイアウト設計
  - [ ] TextInputComponent（2つのテキスト入力）実装
  - [ ] PreviewComponent（生成される文書のプレビュー）実装
  - [ ] DownloadButtonComponent（PDFダウンロード）実装
  - [ ] LoadingComponent（処理中表示）実装
- [ ] **REFACTOR**: UIリファクタリング
  - [ ] コンポーネント最適化
  - [ ] アクセシビリティ改善
  - [ ] レスポンシブデザイン改善
  - [ ] コード品質改善
- [ ] **DOC**: UI技術ドキュメント作成
  - [ ] コンポーネント仕様書
  - [ ] UI実装詳細ドキュメント

## 7. プレビュー機能実装（TDD）

- [ ] **RED**: プレビュー機能テスト作成
  - [ ] リアルタイムプレビューのテスト
  - [ ] プレビュー更新最適化のテスト
  - [ ] スクロール同期のテスト
- [ ] **GREEN**: プレビュー機能実装
  - [ ] リアルタイムプレビュー実装
  - [ ] プレビュー操作機能実装
  - [ ] エラー状態の表示実装
- [ ] **REFACTOR**: プレビュー機能リファクタリング
  - [ ] UX改善
  - [ ] コード品質改善
- [ ] **DOC**: プレビュー機能技術ドキュメント作成
  - [ ] プレビュー機能仕様書
  - [ ] 実装詳細ドキュメント

## 8. PDF生成機能実装（TDD）

- [ ] **RED**: PDF生成テスト作成
  - [ ] 基本的なPDF出力のテスト
  - [ ] 縦書きPDF変換のテスト
  - [ ] 日本語フォント埋め込みのテスト
  - [ ] 差分スタイルPDF反映のテスト
- [ ] **GREEN**: PDF生成実装
  - [ ] PDF生成ライブラリ統合
  - [ ] 縦書きPDF対応
  - [ ] 差分スタイルのPDF反映
  - [ ] PDF最適化
- [ ] **REFACTOR**: PDF生成リファクタリング
  - [ ] コード品質改善
- [ ] **DOC**: PDF生成技術ドキュメント作成
  - [ ] PDF生成API仕様書
  - [ ] 実装詳細ドキュメント

## 9. エラーハンドリング・UX改善実装（TDD）

- [ ] **RED**: エラーハンドリングテスト作成
  - [ ] 入力エラー処理のテスト
  - [ ] PDF生成失敗時のテスト
  - [ ] ネットワークエラー対応のテスト
  - [ ] ローディング状態のテスト
- [ ] **GREEN**: エラーハンドリング実装
  - [ ] エラー処理実装
  - [ ] UX改善実装
  - [ ] パフォーマンス最適化実装
- [ ] **REFACTOR**: エラーハンドリングリファクタリング
  - [ ] エラーメッセージ改善
  - [ ] 回復処理改善
  - [ ] コード品質改善
- [ ] **DOC**: エラーハンドリング技術ドキュメント作成
  - [ ] エラー処理仕様書
  - [ ] トラブルシューティングガイド

## 10. ユーザードキュメント・デプロイ

- [ ] デプロイ準備
  - [ ] 本番環境設定
  - [ ] CDパイプライン構築（自動デプロイ）
  - [ ] モニタリング設定
- [ ] ユーザードキュメント作成
  - [ ] 使用方法ガイド
  - [ ] 入力フォーマット説明書
  - [ ] FAQ作成
